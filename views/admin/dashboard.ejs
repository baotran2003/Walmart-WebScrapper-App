<%- include('../partials/header') -%>
<div class="col-9">
    <div class="container p-3">
        <h1 class="my-4">Dashboard</h1>
        <%- include('../partials/messages') -%>

        <!-- Khai báo và khởi tạo biến một lần duy nhất -->
        <% 
            let total = 0;
            let inStock = 0;
            let outOfStock = 0;
            let priceChanged = 0;
            let backInStock = 0;
            let updated = 0;
            let notUpdated = 0;

            products.forEach((product) => {
                total++;

                if (product.newStock === "In stock") {
                    inStock++;
                }

                if (product.newStock === "Out of stock") {
                    outOfStock++;
                }

                if (product.newPrice !== product.oldPrice) {
                    priceChanged++;
                }

                if (product.oldStock === "Out of stock" && product.newStock === "In stock") {
                    backInStock++;
                }

                if (product.updateStatus === "Updated") {
                    updated++;
                }

                if (product.updateStatus === "Not Updated") {
                    notUpdated++;
                }
            });
        %>

        <!-- Messages -->

        <div class="row">
            <div class="col-xl-12 col-sm-12 mb-3">
                <div class="card text-white bg-primary o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Total Products<br />
                            <b><%= total %></b>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- CARD START HERE -->

        <div class="row">
            <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-success o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            In Stock<br />
                            <b><%= inStock %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/instock">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>

            <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-danger o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Out of Stock<br />
                            <b><%= outOfStock %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/outofstock">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>

            <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-info o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Price Changed<br />
                            <b><%= priceChanged %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/pricechanged">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>

            <div class="col-xl-3 col-sm-6 mb-3">
                <div class="card text-white bg-warning o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Back In Stock<br />
                            <b><%= backInStock %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/backinstock">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>
        </div>

        <!-- UPDATE CARD START HERE -->

        <h1 class="my-5">Products Update Information</h1>

        <div class="row">
            <div class="col-xl-6 col-sm-6 mb-3">
                <div class="card text-white bg-success o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Updated Products<br />
                            <b><%= updated %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/updated">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>

            <div class="col-xl-6 col-sm-6 mb-3">
                <div class="card text-white bg-danger o-hidden h-100">
                    <div class="card-body">
                        <div class="text-center card-font-size">
                            Not Updated Products<br />
                            <b><%= notUpdated %></b>
                        </div>
                    </div>
                    <a class="card-footer text-white clearfix small z-1" href="/products/notupdated">
                        <span class="float-left">View Details</span>
                        <span class="float-right">
                            <i class="fas fa-angle-right"></i>
                        </span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>
<%- include('../partials/footer') -%>